# API –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ API –ø–æ–¥—Ö–æ–¥–∞

### 1. **–£–ø—Ä–æ—â–µ–Ω–∏–µ —Ä–æ—É—Ç–æ–≤**
- –†–æ—É—Ç—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –õ–æ–≥–∏–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ API
- –ß–∏—Å—Ç–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

### 2. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**
- –û–¥–∏–Ω API endpoint –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å—É—â–Ω–æ—Å—Ç–µ–π
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### 3. **–õ—É—á—à–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (separation of concerns)
- –õ–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
- –ü—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
app/
‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ comments.ts          # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π API –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
‚îÇ   ‚îú‚îÄ‚îÄ deals/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ $dealId.tsx         # –†–æ—É—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ forum/
‚îÇ       ‚îî‚îÄ‚îÄ topics/
‚îÇ           ‚îî‚îÄ‚îÄ $topicId.tsx     # –†–æ—É—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ components/
    ‚îú‚îÄ‚îÄ Comments.tsx             # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
    ‚îú‚îÄ‚îÄ deals/
    ‚îÇ   ‚îî‚îÄ‚îÄ DealComments.tsx     # –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Å–∫–∏–¥–æ–∫
    ‚îî‚îÄ‚îÄ forum/
        ‚îî‚îÄ‚îÄ ForumComments.tsx    # –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Ñ–æ—Ä—É–º–∞
```

## üîß API Endpoint

### `/api/comments`

**–ú–µ—Ç–æ–¥:** POST  
**–î–µ–π—Å—Ç–≤–∏—è:**
- `action=add` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
- `action=delete` - —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è  
- `action=rate` - —Ä–µ–π—Ç–∏–Ω–≥ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `entityId` - ID —Å—É—â–Ω–æ—Å—Ç–∏
- `entityType` - —Ç–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏ ('deal', 'forum_topic', etc.)
- `text` - —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è (–¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è)
- `parentId` - ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `commentId` - ID –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è (–¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è/—Ä–µ–π—Ç–∏–Ω–≥–∞)
- `rating` - —Ä–µ–π—Ç–∏–Ω–≥ 1/-1 (–¥–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞)

## üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
```tsx
<Comments
  entityId={dealId}
  entityType="deal"
  comments={comments}
  currentUserId={currentUserId}
  actionUrl="/api/comments"  // –ï–¥–∏–Ω—ã–π API endpoint
/>
```

### –í —Ä–æ—É—Ç–∞—Ö
```tsx
// –†–æ—É—Ç—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
export async function loader({ params, request }) {
  // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  return data({ deal, comments, currentUser });
}

// –õ–æ–≥–∏–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ API
```

## üé® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. **–£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–¥–∞**
- –†–æ—É—Ç—ã —Å—Ç–∞–ª–∏ –ø—Ä–æ—â–µ –∏ —á–∏—â–µ
- –ú–µ–Ω—å—à–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- –ï–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ API

### 2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —Å—É—â–Ω–æ—Å—Ç–µ–π
- API –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–∑ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü—Ä–æ—Å—Ç–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 3. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ï–¥–∏–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- –õ–µ–≥—á–µ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:
1. **–†–æ—É—Ç—ã** - —É–±—Ä–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
2. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—ã–π API endpoint
3. **API** - –¥–æ–±–∞–≤–ª–µ–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π endpoint

### –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å:
1. **–£—Ç–∏–ª–∏—Ç—ã** - `getComments`, `addComment`, etc.
2. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** - UI –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–µ–º –∂–µ
3. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** - –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ **–ö–æ–¥ —É–ø—Ä–æ—â–µ–Ω** - –º–µ–Ω—å—à–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–ª—É—á—à–µ–Ω–∞** - —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞** - –ø—Ä–æ—â–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å

---

**–í—ã–≤–æ–¥:** API –ø–æ–¥—Ö–æ–¥ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—Å—Ç–∏–ª –∫–æ–¥ –∏ —É–ª—É—á—à–∏–ª –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É! üéâ 